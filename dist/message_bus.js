(()=>{"use strict";var e,o,t={680:(e,o,t)=>{t.d(o,{n:()=>Y,V:()=>$});const l=Object.freeze({"5/24":"Early Close","5/31":"Early Close","6/7":"Early Close","6/14":"Early Close","6/21":"Early Close","6/28":"Early Close","7/5":"Early Close","7/12":"Early Close","7/19":"Early Close","7/26":"Early Close","8/2":"Early Close","8/9":"Early Close","8/16":"Early Close","8/23":"Early Close","8/30":"Early Close","9/6":"Early Close"});var n=t(739);const r=Object.freeze({officeHours:"officeHours",homeHours:"homeHours",ptoHours:"ptoHours",holidayHours:"holidayHours",earlyCloseHours:"earlyCloseHours"}),s="ptifrmtgtframe",a="QTY_DAY",i="TRC",u="BUSINESS_UNIT_PC",y="PROJECT_ID",d="DESCR",f="ACTIVITY_ID",c="WFH",g="REG",m="PTO",E="PHOL",h="ERCLS",H="trTR_WEEKLY_GRID$0_row",C="PSLEVEL1GRIDCOLUMNHDR",p=7;let T=null,S=null,I=0,D=0,k=0,v=0;const O={Sunday:1,Monday:2,Tuesday:3,Wednesday:4,Thursday:5,Friday:6,Saturday:7},W={Sun:!0,Mon:!0,Tue:!0,Wed:!0,Thu:!0,Fri:!0,Sat:!0},w={Sun:"Sunday",Mon:"Monday",Tue:"Tuesday",Wed:"Wednesday",Thu:"Thursday",Fri:"Friday",Sat:"Saturday"};let L=[],x=[];function B(){let e=document.getElementById(s);return e.contentDocument||e.contentWindow.document}function b(e){return Number(""===e?0:e)}function $(e){console.log("doing fill.."),T=B(),S=e;let o=S.workWeek,t=o.filter((e=>b(e[r.homeHours])>0));t.length>0?(D=S.timeSplits.length,console.log("homeHoursRows: ",D)):D=0;let s=o.filter((e=>b(e[r.officeHours])>0));s.length>0?(k=S.timeSplits.length,console.log("officeHoursRows: ",k)):k=0;let i=o.filter((e=>b(e[r.ptoHours])>0));v=i.length>0?1:0;let d=N(),H=function(){let e=0;const{dateTexts:o,dayOfWeekTexts:t,dayColumnHeaders:l}=R();console.log("In count needed holiday rows... dateTexts: ",o," dayOfWeekTexts: ",t," dayColumnHeaders: ",l);for(let r=0;r<l.length;r++)n.S[o[r]]&&(e=1,L.push({holidayHours:"8",dayOfWeek:w[t[r]]}));return e}(),C=function(){let e=0;const{dateTexts:o,dayOfWeekTexts:t,dayColumnHeaders:n}=R();for(let r=0;r<n.length;r++)l[o[r]]&&(e=1,x.push({earlyCloseHours:"2",dayOfWeek:w[t[r]]}));return e}();console.log("Holiday rows: ",H),console.log("Holidays in week: ",L),console.log("Early close rows: ",C),console.log("Early close days in week: ",x);let O=D+k+v+H+C;if(console.log("rowCount: ",d," neededRowCount: ",O),console.log("homeHours: ",t," officeHours: ",s," ptoHours: ",i),d<O)alert(`You need to have ${O} row(s), then fill again.`);else{!function(e){for(let o=0;o<e;o++){for(let e=1;e<=p;e++){let t=T.getElementById(a+e+"$"+o);t&&(t.value="")}let e=T.getElementById(u+"$"+o);e&&(e.value="");let t=T.getElementById(y+"$"+o);t&&(t.value="");let l=T.getElementById(f+"$"+o);l&&(l.value="")}}(d);for(let e=0;e<D;e++)_(t,e,c,r.homeHours);I+=D;for(let e=0;e<k;e++)_(s,e,g,r.officeHours);I+=k;for(let e=0;e<v;e++)A(i,e,m,r.ptoHours);I+=v;for(let e=0;e<L.length;e++)A([L[e]],e,E,r.holidayHours);I+=H;for(let e=0;e<x.length;e++)A([x[e]],e,h,r.earlyCloseHours);if(I+=C,d>O&&O===I)for(;I<d;)j(I),F(I),I++;I=0,L=[],H=0,x=[],C=0}}function R(){let e=Array.from(T.getElementsByClassName(C)).filter((e=>W[e.innerText.split("\n")[0]]));return{dateTexts:e.map((e=>e.innerText.split("\n")[1])),dayOfWeekTexts:e.map((e=>e.innerText.split("\n")[0])),dayColumnHeaders:e}}function N(){let e=0;for(let o=1;;o++){if(!T.getElementById(H+o))return e;e++}}function _(e,o,t,l){var n;M(e,o+I,l,(n=o+I,Number(S.timeSplits[n%2].timeSplit/100))),P(o+I,t),j(o+I),F(o+I),function(e){let o=T.getElementById(f+"$"+e);o&&(o.value=function(e){return S.timeSplits[e%2].activity}(e))}(o+I)}function A(e,o,t,l){M(e,o+I,l),P(o+I,t)}function M(e,o,t,l=1){console.log("in fill days of week. workweek: ",e," rowNumber: ",o," selector: ",t);for(let s of e){if(console.log("workday: ",s),(t===r.officeHours||t===r.homeHours)&&L.length>0&&L.filter((e=>e.dayOfWeek===s.dayOfWeek)).length>0){console.log("skipping holiday day... ",s.dayOfWeek," for ",t," hollidaysInWeek: ",L),console.log("filter expr: ",L.filter((e=>e.dayOfWeek===s.dayOfWeek)).length>0);continue}let e=T.getElementById(a+O[s.dayOfWeek]+"$"+o);e&&(e.value=String((n=Number(s[t])*l,Math.round(100*n)/100)))}var n}function P(e,o){let t=T.getElementById(i+"$"+e);t&&(t.value=o)}function j(e){let o=T.getElementById(u+"$"+e);var t;o&&(o.value=(t=e,S.timeSplits[t%2].businessUnit))}function F(e){let o=T.getElementById(y+"$"+e);var t;o&&(o.value=(t=e,S.timeSplits[t%2].timeCode))}function Y(){console.log("Analyzing the schedule!"),T=B();let e=0,o=0,t={},l=N();for(let n=0;n<l;n++){let l=T.getElementById(d+"$"+n);if(!l)continue;let r=l.innerText.trim();if(r){console.log("projectDescription: ",r),t[r]||(t[r]=0);for(let o=1;o<=p;o++){let l=b(T.getElementById(a+o+"$"+n).value);t[r]+=l,e+=l}}else for(let e=1;e<=p;e++)o+=b(T.getElementById(a+e+"$"+n).value)}return{total:e,hoursByProject:t,otherHours:o}}},739:(e,o,t)=>{t.d(o,{S:()=>l});const l=Object.freeze({"1/1":"New Yearâ€™s Day","1/15":"Martin Luther King Jr. Day","2/19":"Presidents Day","3/11":"Verisk Well/being Day","5/27":"Memorial Day","6/19":"Juneteenth","7/4":"Independence Day","9/2":"Labor Day","10/14":"Verisk Well/being Day","11/28":"Thanksgiving Day","11/29":"Day after Thanksgiving Day","12/25":"Christmas Day"})},906:(e,o,t)=>{t.d(o,{D:()=>l});const l=Object.freeze({FILL_SCHEDULE:"fill",CLEAR_SCHEDULE:"clear",LOG_SOMETHING:"logSomething",ANALYZE:"analyze"})}},l={};function n(e){var o=l[e];if(void 0!==o)return o.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,n),r.exports}n.d=(e,o)=>{for(var t in o)n.o(o,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:o[t]})},n.o=(e,o)=>Object.prototype.hasOwnProperty.call(e,o),e=n(680),o=n(906),chrome.runtime.onMessage.addListener(((t,l,n)=>{t.action===o.D.FILL_SCHEDULE?(console.log("Filling the schedule!"),console.log("message: ",t),(0,e.V)(t.data)):t.action===o.D.ANALYZE&&(console.log("Analyzing the schedule!"),console.log("message: ",t),n({data:(0,e.n)()}))}))})();